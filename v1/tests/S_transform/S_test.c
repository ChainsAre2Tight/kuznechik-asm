#include <stdio.h>
#include <string.h>
#include "../utils/blocks.h"

extern void transform_S(unsigned char block[16]);

struct STestData {
    unsigned char block[16];
    unsigned char expected[16];
};

int main() {
    struct STestData test_0 = {
        {
            0xff, 0xee, 0xdd, 0xcc,
            0xbb, 0xaa, 0x99, 0x88,
            0x11, 0x22, 0x33, 0x44,
            0x55, 0x66, 0x77, 0x00,
        }, {
            0xb6, 0x6c, 0xd8, 0x88,
            0x7d, 0x38, 0xe8, 0xd7,
            0x77, 0x65, 0xae, 0xea,
            0x0c, 0x9a, 0x7e, 0xfc,
        }
    };
    struct STestData test_1 = {
        {
            0xb6, 0x6c, 0xd8, 0x88,
            0x7d, 0x38, 0xe8, 0xd7,
            0x77, 0x65, 0xae, 0xea,
            0x0c, 0x9a, 0x7e, 0xfc,
        }, {
            0x55, 0x9d, 0x8d, 0xd7,
            0xbd, 0x06, 0xcb, 0xfe,
            0x7e, 0x7b, 0x26, 0x25,
            0x23, 0x28, 0x0d, 0x39,
        },
    };
    struct STestData test_2 = {
        {
            0x55, 0x9d, 0x8d, 0xd7,
            0xbd, 0x06, 0xcb, 0xfe,
            0x7e, 0x7b, 0x26, 0x25,
            0x23, 0x28, 0x0d, 0x39,
        }, {
            0x0c, 0x33, 0x22, 0xfe,
            0xd5, 0x31, 0xe4, 0x63,
            0x0d, 0x80, 0xef, 0x5c,
            0x5a, 0x81, 0xc5, 0x0b,
        }
    };
    struct STestData test_3 = {
        {
            0x0c, 0x33, 0x22, 0xfe,
            0xd5, 0x31, 0xe4, 0x63,
            0x0d, 0x80, 0xef, 0x5c,
            0x5a, 0x81, 0xc5, 0x0b,
        }, {
            0x23, 0xae, 0x65, 0x63,
            0x3f, 0x84, 0x2d, 0x29,
            0xc5, 0xdf, 0x52, 0x9c,
            0x13, 0xf5, 0xac, 0xda,
        }
    };

    const int num_tests = 4;
    struct STestData* tt[] = {
        &test_0,
        &test_1,
        &test_2,
        &test_3,
    };


    for (int test_id = 0; test_id < num_tests; test_id++) {
        struct STestData* td = tt[test_id];

        transform_S(td->block);
        if (compare_blocks(td->expected, td->block) == 0) {
            printf("test #%d fail, \nExpected:\n", test_id);
            print_block(tt[test_id]->expected);
            printf("Got:\n");
            print_block(td->block);
        } else {
            printf("test #%d pass\n", test_id);
        }
    }
}

